<html>
<head>
	<title>Labpart2</title>
	<link href="favicon.ico" rel="shortcut icon">
	<!-- the Leaflet CSS -->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css"/>
	<!-- the Leaflet JavaScript library -->
	<script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src= "https://cdn.jsdelivr.net/npm/leaflet-legend@1.0.2/leaflet-legend.min.js"></script>
	<link href="lab2part2.css" rel="stylesheet"/>

</head>

<body>
	<h1>Typhoon Haiyan Tracks</h1>
	<div id="map"></div>
	<p>This map depicts the track of Typhoon Haiyan. Data comes from the <a href="https://data.humdata.org/search?q=Typhoon%20Yolanda%2FHaiyan%20sources&ext_page_size=25&sort=score%20desc%2C%20if%20desc">The Humanitarian Data Exchange</a>. Super Typhoon Haiyan, a Category 5 storm, hit the Philippines on Nov. 8, 2013. And it was one of the most powerful storms in 21 century. Typhoon is visualized with proportional symbols where Typhoon of a higher class is depicted with larger circle markers. Click on a circle for more information about the typhoon.</p>
	<div id="legend">
		<h3><center>Typhoon Classification</center></h3>
		<ul>
			<li>
				<svg>
					<circle cx="16" cy="20" r="2" stroke="red" stroke-width="3" fill="red" fill-opacity=".4"/>
				</svg>
				<text>Tropical depression</text>
			</li>
			<li>
				<svg>
					<circle cx="16" cy="18" r="4" stroke="red" stroke-width="3" fill="red" fill-opacity=".4"/>
				</svg>
				<text>Tropical storm</text>
			</li>
			<li>
				<svg>
					<circle cx="16" cy="16" r="6" stroke="red" stroke-width="3" fill="red" fill-opacity=".4"/>
				</svg>
				<text>Category 1</text>
			</li>
			<li>
				<svg>
					<circle cx="16" cy="16" r="8" stroke="red" stroke-width="3" fill="red" fill-opacity=".4"/>
				</svg>
				<text>Category 2</text>
			</li>
			<li>
				<svg>
					<circle cx="16" cy="16" r="10" stroke="red" stroke-width="3" fill="red" fill-opacity=".4"/>
				</svg>
				<text>Category 3</text>
			</li>
			<li>
				<svg>
					<circle cx="16" cy="14" r="12" stroke="red" stroke-width="3" fill="red" fill-opacity=".4"/>
				</svg>
				<text>Category 4</text>
			</li>
			<li>
				<svg>
					<circle cx="16" cy="17" r="14" stroke="red" stroke-width="3" fill="red" fill-opacity=".4"/>
				</svg>
				<text x="0" y="0)">Category 5</text>
			</li>
		</ul>
	</div>
	<!-- code where we build the map and its functionality -->
	<script>
		var mymap = L.map('map').setView([10, 130], 4);

		var basemap = L.tileLayer('https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.png', {
			attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
		}).addTo(mymap);

		// load GeoJSON from an external file and add it to the map
		$.getJSON("https://embed.github.com/view/geojson/Chian-Yu/lab2part2/blob/main/GDACSEventTimeLine.geojson",function(data){
			L.geoJson(data, {
					pointToLayer: function(feature, latlng){
							var radiusSize,
							tClass = feature.properties.Category;
									if (tClass == "Category 5") radiusSize = 14;
									else if (tClass == "Category 4") radiusSize = 12;
									else if (tClass == "Category 3") radiusSize = 10;
									else if (tClass == "Category 2") radiusSize = 8;
									else if (tClass == "Category 1") radiusSize = 6;
									else if (tClass == "Tropical storm") radiusSize = 4;
									else radiusSize = 2;
							var marker = L.circleMarker(latlng, {radius: radiusSize, color: 'red'});
							marker.bindPopup("Time: " + feature.properties.DateUTC + "<br>Classification: " + feature.properties.Category + "<br>Wind Speed: " + feature.properties.WindSpeed + "<br>Wind Guest: " + feature.properties.WindGusts);
							return marker;
					}
			  }).addTo(mymap);
			});
			$.getJSON("https://embed.github.com/view/geojson/Chian-Yu/lab2part2/blob/main/Yolanda%20Path%20Line.json",function(data){
			    L.geoJson(data).addTo(mymap);
			});
			var Legend =  new L.Control.Legend({
				position: 'bottomright',
			});

			mymap.addControl(Legend);
			$(".legend-container").append( $("#legend") );

	</script>
</body>
</html>
